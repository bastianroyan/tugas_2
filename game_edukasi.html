<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Matematika Whack-a-Mole</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .game-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            max-width: 800px;
            width: 100%;
            text-align: center;
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            font-size: 1.2em;
            font-weight: bold;
        }

        .score {
            color: #27ae60;
        }

        .time {
            color: #e74c3c;
        }

        .question {
            font-size: 2em;
            color: #2c3e50;
            margin-bottom: 30px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border: 3px solid #3498db;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .holes-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .hole {
            width: 120px;
            height: 120px;
            background: #8b4513;
            border-radius: 50%;
            position: relative;
            margin: 0 auto;
            border: 5px solid #654321;
            box-shadow: inset 0 10px 20px rgba(0,0,0,0.5);
            overflow: hidden;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><rect x="14" y="4" width="4" height="20" fill="%23A0522D" rx="2"/><ellipse cx="16" cy="2" rx="3" ry="2" fill="%23654321"/><rect x="13" y="22" width="6" height="8" fill="%23654321" rx="3"/></svg>') 16 16, pointer;
        }

        .mole {
            width: 100px;
            height: 100px;
            background: linear-gradient(45deg, #8B4513, #A0522D);
            border-radius: 50% 50% 40% 40%;
            position: absolute;
            bottom: -100px;
            left: 50%;
            transform: translateX(-50%);
            transition: bottom 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            border: 3px solid #654321;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            overflow: visible;
        }

        .mole::before {
            content: '';
            position: absolute;
            top: -15px;
            left: 20px;
            width: 15px;
            height: 25px;
            background: #8B4513;
            border-radius: 50% 50% 0 0;
            transform: rotate(-20deg);
        }

        .mole::after {
            content: '';
            position: absolute;
            top: -15px;
            right: 20px;
            width: 15px;
            height: 25px;
            background: #8B4513;
            border-radius: 50% 50% 0 0;
            transform: rotate(20deg);
        }

        .mole-face {
            position: relative;
            width: 100%;
            height: 60%;
        }

        .mole-eyes {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
        }

        .eye {
            width: 8px;
            height: 8px;
            background: black;
            border-radius: 50%;
        }

        .mole-nose {
            position: absolute;
            top: 35px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 4px;
            background: #2c3e50;
            border-radius: 50%;
        }

        .mole-mouth {
            position: absolute;
            top: 42px;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 6px;
            border: 2px solid #2c3e50;
            border-top: none;
            border-radius: 0 0 12px 12px;
        }

        .mole-number {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.9);
            color: #2c3e50;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
        }

        .mole.show {
            bottom: 10px;
            animation: wiggle 0.5s ease-in-out infinite;
        }

        @keyframes wiggle {
            0%, 100% { transform: translateX(-50%) rotate(-3deg); }
            50% { transform: translateX(-50%) rotate(3deg); }
        }

        .mole:hover {
            transform: translateX(-50%) scale(1.1);
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 15px 30px;
            font-size: 1.2em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .start-btn {
            background: #27ae60;
            color: white;
        }

        .start-btn:hover {
            background: #2ecc71;
            transform: translateY(-2px);
        }

        .reset-btn {
            background: #e74c3c;
            color: white;
        }

        .reset-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .game-over {
            display: none;
            background: rgba(0,0,0,0.8);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .game-over-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3em;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            opacity: 0;
            pointer-events: none;
            z-index: 999;
        }

        .feedback.show {
            animation: feedbackPop 1s ease;
        }

        @keyframes feedbackPop {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }

        .answer-reveal {
            position: fixed;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(52, 152, 219, 0.95);
            color: white;
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 2em;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            opacity: 0;
            pointer-events: none;
            z-index: 998;
        }

        .answer-reveal.show {
            animation: answerReveal 2s ease;
        }

        @keyframes answerReveal {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8) rotateY(-90deg); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1) rotateY(0deg); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1) rotateY(0deg); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8) rotateY(90deg); }
        }

        .score-popup {
            position: fixed;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5em;
            font-weight: bold;
            color: #f1c40f;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            opacity: 0;
            pointer-events: none;
            z-index: 1000;
        }

        .score-popup.show {
            animation: scorePopup 1.5s ease;
        }

        @keyframes scorePopup {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5) rotate(-180deg); }
            30% { opacity: 1; transform: translate(-50%, -50%) scale(1.3) rotate(0deg); }
            60% { opacity: 1; transform: translate(-50%, -50%) scale(1.1) rotate(0deg); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8) rotate(180deg); }
        }

        .mole.hit {
            animation: moleHit 0.5s ease;
        }

        @keyframes moleHit {
            0% { transform: translateX(-50%) scale(1) rotate(0deg); }
            25% { transform: translateX(-50%) scale(1.2) rotate(-10deg); }
            50% { transform: translateX(-50%) scale(0.8) rotate(10deg); }
            75% { transform: translateX(-50%) scale(1.1) rotate(-5deg); }
            100% { transform: translateX(-50%) scale(1) rotate(0deg); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ðŸŽ¯ Game Matematika Whack-a-Mole ðŸŽ¯</h1>
        
        <div class="game-info">
            <div class="score">Skor: <span id="score">0</span></div>
            <div class="time">Waktu: <span id="time">60</span>s</div>
        </div>

        <div class="question" id="question">Klik "Mulai" untuk bermain!</div>

        <div class="holes-grid">
            <div class="hole" data-index="0">
                <div class="mole" id="mole-0">
                    <div class="mole-face">
                        <div class="mole-eyes">
                            <div class="eye"></div>
                            <div class="eye"></div>
                        </div>
                        <div class="mole-nose"></div>
                        <div class="mole-mouth"></div>
                    </div>
                    <div class="mole-number"></div>
                </div>
            </div>
            <div class="hole" data-index="1">
                <div class="mole" id="mole-1">
                    <div class="mole-face">
                        <div class="mole-eyes">
                            <div class="eye"></div>
                            <div class="eye"></div>
                        </div>
                        <div class="mole-nose"></div>
                        <div class="mole-mouth"></div>
                    </div>
                    <div class="mole-number"></div>
                </div>
            </div>
            <div class="hole" data-index="2">
                <div class="mole" id="mole-2">
                    <div class="mole-face">
                        <div class="mole-eyes">
                            <div class="eye"></div>
                            <div class="eye"></div>
                        </div>
                        <div class="mole-nose"></div>
                        <div class="mole-mouth"></div>
                    </div>
                    <div class="mole-number"></div>
                </div>
            </div>
            <div class="hole" data-index="3">
                <div class="mole" id="mole-3">
                    <div class="mole-face">
                        <div class="mole-eyes">
                            <div class="eye"></div>
                            <div class="eye"></div>
                        </div>
                        <div class="mole-nose"></div>
                        <div class="mole-mouth"></div>
                    </div>
                    <div class="mole-number"></div>
                </div>
            </div>
            <div class="hole" data-index="4">
                <div class="mole" id="mole-4">
                    <div class="mole-face">
                        <div class="mole-eyes">
                            <div class="eye"></div>
                            <div class="eye"></div>
                        </div>
                        <div class="mole-nose"></div>
                        <div class="mole-mouth"></div>
                    </div>
                    <div class="mole-number"></div>
                </div>
            </div>
            <div class="hole" data-index="5">
                <div class="mole" id="mole-5">
                    <div class="mole-face">
                        <div class="mole-eyes">
                            <div class="eye"></div>
                            <div class="eye"></div>
                        </div>
                        <div class="mole-nose"></div>
                        <div class="mole-mouth"></div>
                    </div>
                    <div class="mole-number"></div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="start-btn" onclick="startGame()">ðŸŽ® Mulai</button>
            <button class="reset-btn" onclick="resetGame()">ðŸ”„ Reset</button>
        </div>
    </div>

    <div class="game-over" id="gameOver">
        <div class="game-over-content">
            <h2>ðŸŽ‰ Permainan Selesai! ðŸŽ‰</h2>
            <p>Skor Akhir: <span id="finalScore">0</span></p>
            <p id="performance"></p>
            <button class="start-btn" onclick="resetGame()">Main Lagi</button>
        </div>
    </div>

    <div class="feedback" id="feedback"></div>
    <div class="answer-reveal" id="answerReveal"></div>
    <div class="score-popup" id="scorePopup"></div>

    <script>
        let score = 0;
        let timeLeft = 60;
        let gameActive = false;
        let gameTimer;
        let moleTimer;
        let currentQuestion = {};
        let correctAnswer = 0;
        let questionAnswered = false;

        // Audio context untuk suara
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(frequency, duration, type = 'sine') {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            oscillator.type = type;
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + duration);
        }

        function playCorrectSound() {
            playSound(523, 0.2); // C5
            setTimeout(() => playSound(659, 0.2), 100); // E5
            setTimeout(() => playSound(784, 0.3), 200); // G5
        }

        function playWrongSound() {
            playSound(200, 0.5, 'sawtooth');
        }

        function playClickSound() {
            playSound(800, 0.1, 'square');
        }

        function generateQuestion() {
            const operations = ['+', '-', 'Ã—'];
            const operation = operations[Math.floor(Math.random() * operations.length)];
            let num1, num2, answer;

            switch(operation) {
                case '+':
                    num1 = Math.floor(Math.random() * 20) + 1;
                    num2 = Math.floor(Math.random() * 20) + 1;
                    answer = num1 + num2;
                    break;
                case '-':
                    num1 = Math.floor(Math.random() * 20) + 10;
                    num2 = Math.floor(Math.random() * num1) + 1;
                    answer = num1 - num2;
                    break;
                case 'Ã—':
                    num1 = Math.floor(Math.random() * 9) + 1;
                    num2 = Math.floor(Math.random() * 9) + 1;
                    answer = num1 * num2;
                    break;
            }

            currentQuestion = {
                text: `${num1} ${operation} ${num2} = ?`,
                answer: answer
            };
            
            return currentQuestion;
        }

        function showMoles() {
            if (!gameActive) return;

            // Reset status jawaban
            questionAnswered = false;

            // Sembunyikan semua mole
            document.querySelectorAll('.mole').forEach(mole => {
                mole.classList.remove('show');
                mole.querySelector('.mole-number').textContent = '';
            });

            const question = generateQuestion();
            correctAnswer = question.answer;
            document.getElementById('question').textContent = question.text;

            // Buat array jawaban (1 benar, 5 salah)
            const answers = [correctAnswer];
            while (answers.length < 6) {
                let wrongAnswer;
                do {
                    wrongAnswer = correctAnswer + Math.floor(Math.random() * 20) - 10;
                } while (answers.includes(wrongAnswer) || wrongAnswer < 0);
                answers.push(wrongAnswer);
            }

            // Acak posisi jawaban
            const shuffledAnswers = answers.sort(() => Math.random() - 0.5);

            // Tampilkan mole dengan jawaban (tanpa menunjukkan mana yang benar)
            shuffledAnswers.forEach((answer, index) => {
                const mole = document.getElementById(`mole-${index}`);
                mole.querySelector('.mole-number').textContent = answer;
                mole.classList.add('show');
                
                // Simpan jawaban sebagai data attribute
                mole.dataset.answer = answer;
            });
        }

        function hitMole(moleIndex) {
            if (!gameActive || questionAnswered) return;

            // Tandai bahwa pertanyaan sudah dijawab
            questionAnswered = true;

            playClickSound();
            
            const mole = document.getElementById(`mole-${moleIndex}`);
            const answer = parseInt(mole.dataset.answer);
            const feedback = document.getElementById('feedback');
            const answerReveal = document.getElementById('answerReveal');
            const scorePopup = document.getElementById('scorePopup');

            // Animasi mole terpukul
            mole.classList.add('hit');
            setTimeout(() => mole.classList.remove('hit'), 500);

            // Tampilkan semua jawaban dengan warna (sekarang baru terlihat mana yang benar)
            document.querySelectorAll('.mole').forEach(m => {
                const moleAnswer = parseInt(m.dataset.answer);
                if (moleAnswer === correctAnswer) {
                    m.style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
                    m.querySelector('.mole-face').style.opacity = '0.3';
                    m.querySelector('.mole-number').style.background = '#27ae60';
                    m.querySelector('.mole-number').style.color = 'white';
                } else {
                    m.style.background = 'linear-gradient(45deg, #e74c3c, #c0392b)';
                    m.querySelector('.mole-face').style.opacity = '0.3';
                    m.querySelector('.mole-number').style.background = '#e74c3c';
                    m.querySelector('.mole-number').style.color = 'white';
                }
            });

            let scoreChange = 0;
            if (answer === correctAnswer) {
                scoreChange = 10;
                score += scoreChange;
                feedback.textContent = 'ðŸŽ‰ Benar Sekali!';
                feedback.style.color = '#27ae60';
                scorePopup.textContent = '+' + scoreChange;
                scorePopup.style.color = '#27ae60';
                playCorrectSound();
            } else {
                scoreChange = -5;
                score = Math.max(0, score + scoreChange);
                feedback.textContent = 'ðŸ˜… Oops, Salah!';
                feedback.style.color = '#e74c3c';
                scorePopup.textContent = scoreChange;
                scorePopup.style.color = '#e74c3c';
                playWrongSound();
            }

            // Tampilkan jawaban yang benar
            answerReveal.textContent = `Jawaban: ${currentQuestion.text.replace('= ?', '=')} ${correctAnswer}`;
            
            // Tampilkan semua animasi
            feedback.classList.add('show');
            answerReveal.classList.add('show');
            scorePopup.classList.add('show');

            // Bersihkan animasi
            setTimeout(() => {
                feedback.classList.remove('show');
                answerReveal.classList.remove('show');
                scorePopup.classList.remove('show');
            }, 2000);

            document.getElementById('score').textContent = score;

            clearTimeout(moleTimer);
            
            // Tunggu sebentar sebelum soal berikutnya dan reset tampilan mole
            setTimeout(() => {
                document.querySelectorAll('.mole').forEach(m => {
                    m.classList.remove('show');
                    m.style.background = 'linear-gradient(45deg, #8B4513, #A0522D)';
                    m.querySelector('.mole-face').style.opacity = '1';
                    m.querySelector('.mole-number').style.background = 'rgba(255,255,255,0.9)';
                    m.querySelector('.mole-number').style.color = '#2c3e50';
                });
                showMoles();
            }, 2500);
        }

        function startGame() {
            if (gameActive) return;

            gameActive = true;
            score = 0;
            timeLeft = 60;
            
            document.getElementById('score').textContent = score;
            document.getElementById('time').textContent = timeLeft;
            document.getElementById('gameOver').style.display = 'none';

            // Mulai timer
            gameTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('time').textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);

            showMoles();
        }

        function resetGame() {
            gameActive = false;
            clearInterval(gameTimer);
            clearTimeout(moleTimer);
            
            score = 0;
            timeLeft = 60;
            
            document.getElementById('score').textContent = score;
            document.getElementById('time').textContent = timeLeft;
            document.getElementById('question').textContent = 'Klik "Mulai" untuk bermain!';
            document.getElementById('gameOver').style.display = 'none';
            
            document.querySelectorAll('.mole').forEach(mole => {
                mole.classList.remove('show');
                mole.querySelector('.mole-number').textContent = '';
                mole.style.background = 'linear-gradient(45deg, #8B4513, #A0522D)';
                mole.querySelector('.mole-face').style.opacity = '1';
                mole.querySelector('.mole-number').style.background = 'rgba(255,255,255,0.9)';
                mole.querySelector('.mole-number').style.color = '#2c3e50';
            });
        }

        function endGame() {
            gameActive = false;
            clearInterval(gameTimer);
            clearTimeout(moleTimer);
            
            document.getElementById('finalScore').textContent = score;
            
            let performance = '';
            if (score >= 200) performance = 'ðŸ† Luar Biasa! Kamu jenius matematika!';
            else if (score >= 150) performance = 'ðŸŒŸ Bagus sekali! Terus berlatih!';
            else if (score >= 100) performance = 'ðŸ‘ Cukup baik! Kamu bisa lebih baik lagi!';
            else if (score >= 50) performance = 'ðŸ’ª Tidak buruk! Ayo latihan lagi!';
            else performance = 'ðŸ“š Yuk belajar lagi supaya lebih pintar!';
            
            document.getElementById('performance').textContent = performance;
            document.getElementById('gameOver').style.display = 'flex';
        }

        // Event listeners untuk klik mole
        document.querySelectorAll('.hole').forEach((hole, index) => {
            hole.addEventListener('click', () => {
                const mole = hole.querySelector('.mole');
                if (mole.classList.contains('show')) {
                    hitMole(index);
                }
            });
        });

        // Inisialisasi audio context saat user pertama kali berinteraksi
        document.addEventListener('click', () => {
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
        }, { once: true });
    </script>
</body>
</html>